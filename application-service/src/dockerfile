FROM node:18-alpine

WORKDIR /usr/src/app

# (Optional) Install build tools if needed by any native modules
RUN apk add --no-cache git python3 make g++

# Copy all files (you could copy just package files first, but single-stage)
COPY . .

# Install dependencies
RUN npm ci --only=production

# Clean npm cache to reduce image size
RUN npm cache clean --force

# Expose your app port
EXPOSE 3000

# Set NODE_ENV (optional but good practice)
ENV NODE_ENV=production

# Run the app
CMD ["node", "index.js"]
