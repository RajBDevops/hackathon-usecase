
FROM node:18-alpine AS builder

WORKDIR /usr/src/app


RUN apk add --no-cache git python3 make g++


COPY package*.json ./


RUN npm install


COPY . .


  RUN npm run build

# Production image (only prod dependencies)
FROM node:18-alpine AS production

WORKDIR /usr/src/app


COPY --from=builder /usr/src/app ./


RUN npm prune --production


RUN npm cache clean --force


EXPOSE 3000


CMD ["node", "index.js"]

